sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],function(e,t){"use strict";var o,s;return e.extend("lrftracker.controller.page2",{onInit:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("page2").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){o=e.getParameter("arguments").LRF_Master_ID;s=e.getParameter("arguments").Lrf_No;var t=this;var a=this.getView().getModel();a.metadataLoaded().then(function(){var e="/per_Adani_Logistics_LRF_Master(guid'"+o+"')";t.getView().bindElement({path:e,events:{dataReceived:function(e){console.log(e)}},parameters:{expand:"To_PackingDoc,To_MaterialDesc,To_CkeckList,To_Draft,To_Final,To_DeliveryDetails,To_FF_Shipment,To_FF_Documents"}})});this.OdataGet(o,s)},onAfterRendering:function(){},OdataGet:function(e,t){var o=this.getOwnerComponent().getModel().sServiceUrl;var s=this;o=o+"/per_Adani_Logistics_LRF_Master(guid'"+e+"')";jQuery.ajax({url:o+"?$expand=To_PackingDoc,To_MaterialDesc,To_CkeckList,To_Draft,To_Final,To_DeliveryDetails,To_FF_Shipment,To_FF_Documents",method:"GET",headers:{"Content-Type":"application/json",DataServiceVersion:"2.0","X-CSRF-Token":"Fetch"},success:function(e){var t=new sap.ui.model.json.JSONModel(e.d);this.getOwnerComponent().setModel(t,"objectModel");sap.ui.getCore().setModel(t,"objectModel")}.bind(this),error:function(e){console.error("PATCH request failed: "+e.responseText);alert(e.responseText)}.bind(this)})},onDeliveryDetailsPage:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("DeliveryDetails",{LRF_Master_ID:o,Lrf_No:s})},onFFDetailsPage:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("FFDetails",{LRF_Master_ID:o,Lrf_No:s})},onAccept:function(){var e={LogisticsMPL_Comments:this.getView().byId("mpl_comment").getValue(),LogisticsMPL_Status:"Accept",Submit_Flag:"YES"};var o=this.getView().getModel();var s=o.sServiceUrl;var a="/per_Adani_Logistics_LRF_Master";var r=sap.ui.getCore().getModel("objectModel").getData().LRF_Master_ID;var n=s+a+"(guid'"+r+"')";jQuery.ajax({url:n,method:"PATCH",headers:{"Content-Type":"application/json",DataServiceVersion:"2.0","X-CSRF-Token":"Fetch"},data:JSON.stringify(e),success:function(){console.log("PATCH request successful");t.success("Successfully Accepted LRF");location.reload()},error:function(e){console.error("PATCH request failed: "+e.responseText);alert(e.responseText)}})},emptyComment:function(){if(!this.getView().byId("mpl_comment").getValue()){this.getView().byId("mpl_comment").setValueState("Error")}else{this.getView().byId("mpl_comment").setValueState("None")}},onReturn:function(){if(!this.getView().byId("mpl_comment").getValue()){this.getView().byId("mpl_comment").setValueState("Error");return}var e={LogisticsMPL_Comments:this.getView().byId("mpl_comment").getValue(),LogisticsMPL_Status:"Return",Submit_Flag:"No"};var o=this.getView().getModel();var s=o.sServiceUrl;var a="/per_Adani_Logistics_LRF_Master";var r=sap.ui.getCore().getModel("objectModel").getData().LRF_Master_ID;var n=s+a+"(guid'"+r+"')";jQuery.ajax({url:n,method:"PATCH",headers:{"Content-Type":"application/json",DataServiceVersion:"2.0","X-CSRF-Token":"Fetch"},data:JSON.stringify(e),success:function(){console.log("PATCH request successful");t.success("Successfully Returned LRF");location.reload()},error:function(e){console.error("PATCH request failed: "+e.responseText);alert(e.responseText)}})},onEdit:function(){window.open(`https://port4004-workspaces-ws-7mhdt.ap11.applicationstudio.cloud.sap/project_lnc/webapp/index.html#/importlrf/${s}/None`)}})});